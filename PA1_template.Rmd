---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
```{r loadproc, echo =TRUE}
unzip("activity.zip")
df <- read.csv("activity.csv")
nint <- length(unique(df$interval))
df$date <- as.Date(df$date, "%Y-%m-%d")
df$wkday <- weekdays(df$date)
file.remove("activity.csv")


```

## What is mean total number of steps taken per day?
First we compute the total number of steps taken per day:

```{r mday, echo =TRUE}
sperday <- sapply(split(df$steps, df$date), sum, na.rm = TRUE)
```

Here is the histogram of the total number of steps taken per day:
```{r histmday, echo =TRUE}
hist(sperday, main = "Steps per day", xlab = "", ylab = "Number of days")
```

Average number of steps per day is:

```{r meanday, echo =TRUE}
mean(sperday)
```

Median number of steps per day is:

```{r medday, echo =TRUE}
median(sperday)
```

## Imputing missing values

We substitute the missing values for steps my the mean values with the corresponding 5-minutes interval. We also save the mean values for the number of steps per interval into the vector *mint*

```{r nahandling, echo =TRUE}
mint <- vector(mode = "numeric", length = nint)

templist <- mapply(function(x, y) {
  mint[y] <<- mean(x$steps, na.rm = TRUE)
  x$steps[is.na(x$steps)] <- mint[y]
  return(x)
  }, split(df, df$interval), 1:nint, SIMPLIFY = FALSE)

dfcomp <- do.call(rbind, templist)
rm(templist)
```

## What is the average daily activity pattern?

We convert the vector of mean steps per interval *mint* into a time series:
```{r mintts, echo =TRUE}
mint <- ts(mint)
```

We plot the daily activity pattern across 5-minutes intervals

```{r mintplot, echo =TRUE}
plot(mint, main="Daily Activity Pattern", xlab = "5-minute interval",
     ylab = "Mean number of steps")
```

The interval that has the highest average activity is:
```{r maxact, echo =TRUE}
the interval number", paste(which.max(mint), " with the average number of steps ", max(mint))
```


## Are there differences in activity patterns between weekdays and weekends?
